{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "1b9f3c82_1f7a7ea6",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-07-16T07:59:06Z",
      "side": 1,
      "message": "I have updated the code so that, in places where functions with a void return type previously just returned (as in [Gerrit 80090] ), I now throw `pldm::InstanceIdError(instanceIdResult.error())` instead.\nThe reason I am not simply throwing `instanceIdResult.error()` is because the CI requires exceptions to be thrown as anonymous temporaries.\n\nFor non-void functions, the behavior remains the same as in [Gerrit 80090]: errors are handled by returning an error code (such as `PLDM_ERROR`) rather than throwing exceptions.\nThis avoids previous issues where an uncaught exception due to instance ID allocation failure could cause a pldmd core dump.\n\nFor the remaining areas in void functions where the thrown exception is not yet caught, I am considering introducing a function template to avoid code duplication while still allowing proper exception handling.\n\nShould these related changes be included in this patch, or submitted as a separate commit?\n\n[Gerrit 80090]: https://gerrit.openbmc.org/c/openbmc/pldm/+/80090",
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "75baa8a9_389f67da",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1000945
      },
      "writtenOn": "2025-09-03T07:38:35Z",
      "side": 1,
      "message": "Make sure you cover all of code call `instanceIdDb.next()`.",
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "bea35209_4ce8c09f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 4
      },
      "lineNbr": 0,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-09-09T08:02:51Z",
      "side": 1,
      "message": "The merge conflict has been resolved.\nUpon reviewing the code, I found that all existing usages of `instanceIdDb.next()` and `instanceIdDb-\u003enext()` are already handled via `pldm::utils::getInstanceId()`.",
      "parentUuid": "75baa8a9_389f67da",
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0827d15b_983f5eb1",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 175,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-09-12T06:06:02Z",
      "side": 1,
      "message": "typo",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 10
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1c1ab7e1_25cf8716",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 175,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-09-15T13:36:19Z",
      "side": 1,
      "message": "I\u0027m not sure whether `@tparam T - InstanceId value type` is the best phrasing, or if you have other suggestions for the `@tparam` description.",
      "parentUuid": "0827d15b_983f5eb1",
      "range": {
        "startLine": 175,
        "startChar": 4,
        "endLine": 175,
        "endChar": 10
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8d491b3b_763f6548",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 178,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-09-12T06:06:02Z",
      "side": 1,
      "message": "aligment problems",
      "range": {
        "startLine": 177,
        "startChar": 0,
        "endLine": 178,
        "endChar": 52
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "73993623_39d7e615",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 178,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-09-15T13:36:19Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8d491b3b_763f6548",
      "range": {
        "startLine": 177,
        "startChar": 0,
        "endLine": 178,
        "endChar": 52
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fd0a9a51_3524b221",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-09-12T06:06:02Z",
      "side": 1,
      "message": "PLDM uses lg2 for logging.",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5519bc11_0f94cf50",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-09-15T13:36:19Z",
      "side": 1,
      "message": "I added `phosphor-logging` in pldmtool\u0027s `meson.build` since `getInstanceId` was changed from `std::cerr` to `lg2::error`, which caused a linker error in CI due to missing symbols from `libphosphor_logging`.",
      "parentUuid": "fd0a9a51_3524b221",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e4ada262_fe1be223",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-09-19T10:18:02Z",
      "side": 1,
      "message": "ah , i see i dont want pldmtool to use the lg2. Since the lg2 logs looks a bit odd for command line based tools. Can you please revert back to `std::cerr`.\n\nI don\u0027t have any concerns on this commit otherwise.",
      "parentUuid": "5519bc11_0f94cf50",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "27fb7e73_eba017c2",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2025-09-19T14:49:38Z",
      "side": 1,
      "message": "This implies that no \"common\" code could use lg2.  Why is that?  What \"looks odd\" about it?",
      "parentUuid": "e4ada262_fe1be223",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e0eeef4_7428f575",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1002134
      },
      "writtenOn": "2025-09-22T10:43:35Z",
      "side": 1,
      "message": "To validate the difference between `std::cerr` and `lg2::error` in pldmtool, I forced `instanceIdDb.next()` to return early with rc \u003d `-EAGAIN`.\n\nThe outputs were:\nstd::cerr:\n```\nroot@bmc:~# pldmtool base GetTID -m 10\nError message printed by std::cerr\nFailed to allocate instance ID for EID 10: No free instance ids\nterminate called after throwing an instance of \u0027pldm::InstanceIdError\u0027\n  what(): Failed to allocate instance ID for EID 10: No free instance ids Aborted (core dumped)\n```\nlg2::error:\n```\nroot@bmc:~# pldmtool base GetTID -m 10\n\u003c3\u003e Error message printed by lg2::error\n\u003c3\u003e Failed to allocate instance ID for EID 10: No free instance ids\nterminate called after throwing an instance of \u0027pldm::InstanceIdError\u0027\n  what(): Failed to allocate instance ID for EID 10: No free instance ids Aborted (core dumped)\n```\n\nThe visible difference is the “\u003c3\u003e” prefix, I’d like to get consensus from both of you before proceeding.",
      "parentUuid": "27fb7e73_eba017c2",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63086da7_b8e9b48d",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-09-23T06:50:04Z",
      "side": 1,
      "message": "\u003e This implies that no \"common\" code could use lg2. Why is that? What \"looks odd\" about it?\n\n@eric.yang.wiwynn@gmail.com - thanks for the test. Exactly, the `\u003c number \u003e` prior to every trace spit from pldmtool is what made me feel that those look odd.",
      "parentUuid": "4e0eeef4_7428f575",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "09e502ef_821f4878",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2025-09-23T10:29:21Z",
      "side": 1,
      "message": "\u003e Exactly, the \u003c number \u003e prior to every trace spit from pldmtool is what made me feel that those look odd.\n\nIs this really a problem?  Google logging, Rust logging, they all put the \"level\" into the output.  This is pretty standard practice these days.  If it is just that we don\u0027t like the \u003c1\u003e and would rather have INFO or \u003cI\u003e we can make that change in phosphor-logging.\n\nI don\u0027t think we should explicitly avoid the preferred logging in common code just because we are also using that code in a CLI.",
      "parentUuid": "63086da7_b8e9b48d",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "79fe4e27_a0b0c872",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-10-09T10:22:01Z",
      "side": 1,
      "message": "\u003e Is this really a problem?  Google logging, Rust logging, they all put the \"level\" into the output.  This is pretty standard practice these days.  If it is just that we don\u0027t like the \u003c1\u003e and would rather have INFO or \u003cI\u003e we can make that change in phosphor-logging.\n\u003e \n\nLooking at how other logging utilizes like `dmesg` strip out the \u003cn\u003e while displaying logs, was thinking if this needs to be implemented within `pldmtool` or with in `logging`. we seem to have `LG2_FORMAT` environment variable, right ? setting it to just \"%m\" for pldmtool would not work ? \n\n\u003e I don\u0027t think we should explicitly avoid the preferred logging in common code just because we are also using that code in a CLI.\n\nagree, I am not against using lg2 in common code - just wanted things to be a little cleaner.",
      "parentUuid": "09e502ef_821f4878",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "75044b0d_ed942c49",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2025-10-14T18:56:01Z",
      "side": 1,
      "message": "\u003e we seem to have LG2_FORMAT environment variable, right ? setting it to just \"%m\" for pldmtool would not work ?\n\nThe challenge would be that the phosphor-logging library likely reads the variable before you have any ability to override it in the executable itself.  You\u0027d have to do some strange things like having an executable that first sets the variable, then fork/exec\u0027s (itself?) in order to get the variable reapplied.  To me, this doesn\u0027t seem like valuable work.",
      "parentUuid": "79fe4e27_a0b0c872",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b7596147_bb72c54d",
        "filename": "common/utils.hpp",
        "patchSetId": 4
      },
      "lineNbr": 186,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2025-12-17T06:19:48Z",
      "side": 1,
      "message": "ah, I did not realize, that makes sense.\n\nI can put up a patch in phosphor-logging change, unless anyone wants to \u0026 beats me to it. And I see no reason to block this review with this comment as that could go in parallel",
      "parentUuid": "75044b0d_ed942c49",
      "range": {
        "startLine": 186,
        "startChar": 7,
        "endLine": 186,
        "endChar": 18
      },
      "revId": "f7e37ceb8f4793f14dde8d5d3128dfeb15140c63",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}