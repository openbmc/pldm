{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "461895ce_744067a2",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 19
      },
      "lineNbr": 0,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2023-04-20T06:43:08Z",
      "side": 1,
      "message": "@tom - do you have any comments ?",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "633acdc4_551d9fdb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 19
      },
      "lineNbr": 0,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2023-05-08T03:42:37Z",
      "side": 1,
      "message": "The time out is being considered as useconds, so 5 is being considered as 5 useconds, we need to consider 5 as 5 seconds.\n\nvirtual int sd_bus_call(sd_bus* bus, sd_bus_message* m, uint64_t usec,\n\nplease re-work on the code.",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2a6c163f_54363f3a",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 19
      },
      "lineNbr": 0,
      "author": {
        "id": 1000005
      },
      "writtenOn": "2023-05-15T02:29:42Z",
      "side": 1,
      "message": "How was this tested?\n\n`Tested by adding a sleep for 10 seconds inside main function of\nphospher-host-postd and executed get dbus property on snoopd. PLDM\ndbus call timed out after 5 seconds.`",
      "parentUuid": "633acdc4_551d9fdb",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "5298f96c_4797e76b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 19
      },
      "lineNbr": 0,
      "author": {
        "id": 1000393
      },
      "writtenOn": "2023-05-19T12:12:27Z",
      "side": 1,
      "message": "This was initially tested with normal IPL and re-ipl and the bad path was tested with a getdbus property that timed out in 5 seconds . after some review comments we removed the conversion \nstd::chrono::microseconds timeout \u003d std::chrono::microseconds(DBUS_TIMEOUT); and directly sent DBUS_TIMEOUT value to bus.call . This was not retested with IPLs. Since bus.call considers time in micro seconds and not in seconds we sent timeout as 5usecs. before merge when this was tested we could not IPL because the pldmd timed out too quickly. \n\nI have made corrections and added the coversions back and retested . Test details are added on the commit message",
      "parentUuid": "2a6c163f_54363f3a",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e11d59d0_d5e40510",
        "filename": "meson_options.txt",
        "patchSetId": 19
      },
      "lineNbr": 19,
      "author": {
        "id": 1000005
      },
      "writtenOn": "2023-05-04T07:15:09Z",
      "side": 1,
      "message": "We should default to systemd timeout of 25 seconds and allow platforms to choose the preferred timeout.\n\nHow is the min value of 3 decided?\n\n@Manoj as a side topic, we should consider introducing async D-Bus client calls for cases, where we don\u0027t want PLDM daemon to be help up for long running operations.",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6af7dfab_5dcc3aef",
        "filename": "meson_options.txt",
        "patchSetId": 19
      },
      "lineNbr": 19,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2023-05-04T07:39:03Z",
      "side": 1,
      "message": "yes - we could make the default as systemd\u0027s default.\n\nAs a standard pldm instance id expiration time is max 5 seconds, if we have the timeout of dbus as 25seconds, we are always bound to respond after 25seconds and that will not be useful as the remote terminus requests and retries would be completed in the first 5 seconds of the 25seconds.\n\nAgree that this would not fix the entire issue, but this would make this worse in bad situations.\n\nNot sure if there is a timing spec for dbus, but we felt 3 seconds would be a reasonable time for a daemon to respond for a dbus message[provided the daemon is running on a bmc that has very less computation resources and is busy].\n\nIf needed we could default this to systemd default ,and over ride that via meta-ibm layer if needed. What do you think is the best way forward ?\n\n\u003e @Manoj as a side topic, we should consider introducing async D-Bus client calls for cases, where we don\u0027t want PLDM daemon to be help up for long running operations.\n\nYes, we started to work on some prototypes to make things async, but it seems like a pretty big infrastructure change and its gonna take time. We can have this meson option removed once we have the async infrastructure change in.",
      "parentUuid": "e11d59d0_d5e40510",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ec80296e_8d7ee1bc",
        "filename": "meson_options.txt",
        "patchSetId": 19
      },
      "lineNbr": 19,
      "author": {
        "id": 1000206
      },
      "writtenOn": "2023-05-04T07:40:01Z",
      "side": 1,
      "message": "Haging for 5 seconds is atleast better than hanging for 25 seconds :)",
      "parentUuid": "6af7dfab_5dcc3aef",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ab4f365e_c1e792e6",
        "filename": "meson_options.txt",
        "patchSetId": 19
      },
      "lineNbr": 19,
      "author": {
        "id": 1000005
      },
      "writtenOn": "2023-05-04T08:20:32Z",
      "side": 1,
      "message": "The instance ID expiration time of 5-6 secs is a good rationale to have a D-Bus timeout of 5 sec.",
      "parentUuid": "ec80296e_8d7ee1bc",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "82134d9e_cc764b69",
        "filename": "meson_options.txt",
        "patchSetId": 19
      },
      "lineNbr": 19,
      "author": {
        "id": 1000005
      },
      "writtenOn": "2023-06-14T02:02:37Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "ab4f365e_c1e792e6",
      "revId": "acb4054e5d7e7f16e16afecbcd026dcafde70536",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}